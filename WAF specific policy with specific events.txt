SELECT 
  "sourceIP" AS "Source IP", 
  QIDNAME(qid) AS "Event Name", 
   CATEGORYNAME(category) AS "Low Level Category", 
   "Action" AS "Action (custom)", 
   "Policy Name" AS "Policy Name", 
  DATEFORMAT(starttime, 'YYYY-MM-dd hh:mm:ss') AS "Time", 
  COUNT(*) AS "Count" ,
  LOGSOURCENAME(logSourceId) AS "Log Source", 
  "sourcePort" AS "Source Port", 
  "destinationIP" AS "Destination IP", 
  "destinationPort" AS "Destination Port", 
  "URL Host" AS "URL Host"
FROM events 
WHERE 
  logSourceId IN (119, 184, 204, 299, 497, 655, 858, 2281)
    AND sourceIP NOT IN ('IP1', 'IP2')
    AND QIDNAME(qid) NOT IN ('POST', 'GET', 'OPTIONS', 'PUT', 'HEAD', 'Illegal POST Data Length', 'Illegal cross-origin request', 'Illegal Request Length')
    AND (QIDNAME(qid) NOT IN('HTTP Compliance Failure') AND "Policy Name"  NOT IN ('#POLICY NAME'))
    AND "eventDirection" = 'R2L'
GROUP BY
  "Action",  "sourceIP",  "Policy Name"
ORDER BY 
  "Count" DESC 
LAST 30 MINUTES

